function lYearDays(e){var t,n=348;for(t=32768;t>8;t>>=1)n+=lunarInfo[e-1900]&t?1:0;return n+leapDays(e)}function leapDays(e){return leapMonth(e)?65536&lunarInfo[e-1900]?30:29:0}function leapMonth(e){return 15&lunarInfo[e-1900]}function monthDays(e,t){return lunarInfo[e-1900]&65536>>t?30:29}function Lunar(e){var t,n=0,s=0,a=(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate())-Date.UTC(1900,0,31))/864e5;for(t=1900;2050>t&&a>0;t++)s=lYearDays(t),a-=s;for(0>a&&(a+=s,t--),this.year=t,n=leapMonth(t),this.isLeap=!1,t=1;13>t&&a>0;t++)n>0&&t==n+1&&0==this.isLeap?(--t,this.isLeap=!0,s=leapDays(this.year)):s=monthDays(this.year,t),1==this.isLeap&&t==n+1&&(this.isLeap=!1),a-=s;0==a&&n>0&&t==n+1&&(this.isLeap?this.isLeap=!1:(this.isLeap=!0,--t)),0>a&&(a+=s,--t),this.month=t,this.day=a+1}function solarDays(e,t){return 1==t?0==e%4&&0!=e%100||0==e%400?29:28:solarMonth[t]}function cyclical(e){return Gan[e%10]+Zhi[e%12]}function calElement(e,t,n,s,a,l,d,o,r,i,c){this.isToday=!1,this.sYear=e,this.sMonth=t,this.sDay=n,this.week=s,this.lYear=a,this.lMonth=l,this.lDay=d,this.isLeap=o,this.cYear=r,this.cMonth=i,this.cDay=c,this.color="",this.lunarFestival="",this.solarFestival="",this.solarTerms="",this.numberWeek=""}function sTerm(e,t){var n=new Date(31556925974.7*(e-1900)+6e4*sTermInfo[t]+Date.UTC(1900,0,6,2,5));return n.getUTCDate()}function calendar(e,t){var n,s,a,l,d,o,r,i,c,y,h,m,u=1,D=0,g=Array(3),f=0,p=0;n=new Date(e,t,1,0,0,0,0),this.length=solarDays(e,t),this.firstWeek=n.getDay(),c=2>t?cyclical(e-1900+36-1):cyclical(e-1900+36);var v=sTerm(e,2),L=sTerm(e,2*t);y=cyclical(12*(e-1900)+t+12);for(var M=Date.UTC(e,t,1,0,0,0,0)/864e5+25567+10,x=0;this.length>x;x++)u>D&&(n=new Date(e,t,x+1),s=new Lunar(n),a=s.year,l=s.month,u=s.day,d=s.isLeap,D=d?leapDays(a):monthDays(a,l),0==f&&(p=l),g[f++]=x-u+1),1==t&&x+1==v&&(c=cyclical(e-1900+36)),x+1==L&&(y=cyclical(12*(e-1900)+t+13)),h=cyclical(M+x),this[x]=new calElement(e,t+1,x+1,eStr1[(x+this.firstWeek)%7],a,l,u++,d,c,y,h,m);o=sTerm(e,2*t)-1,r=sTerm(e,2*t+1)-1,this[o].solarTerms=solarTerm[2*t],this[r].solarTerms=solarTerm[2*t+1],3==t&&(this[o].color="red");for(x in sFtv)sFtv[x].match(/^(\d{2})(\d{2})([\s\*])(.+)$/)&&Number(RegExp.$1)==t+1&&(this[Number(RegExp.$2)-1].solarFestival+=RegExp.$4+" ","*"==RegExp.$3&&(this[Number(RegExp.$2)-1].color="red"));for(x in wFtv)wFtv[x].match(/^(\d{2})(\d)(\d)([\s\*])(.+)$/)&&Number(RegExp.$1)==t+1&&(o=Number(RegExp.$2),r=Number(RegExp.$3),5>o?this[(this.firstWeek>r?7:0)+7*(o-1)+r-this.firstWeek].solarFestival+=RegExp.$5+" ":(o-=5,i=(this.firstWeek+this.length-1)%7,this[this.length-i-7*o+r-(r>i?7:0)-1].solarFestival+=RegExp.$5+" "));for(x in lFtv)lFtv[x].match(/^(\d{2})(.{2})([\s\*])(.+)$/)&&(o=Number(RegExp.$1)-p,-11==o&&(o=1),o>=0&&f>o&&(r=g[o]+Number(RegExp.$2)-1,r>=0&&this.length>r&&1!=this[r].isLeap&&(this[r].lunarFestival+=RegExp.$4+" ","*"==RegExp.$3&&(this[r].color="red"))));if(2==t||3==t){var I=new easter(e);t==I.m&&(this[I.d-1].solarFestival=this[I.d-1].solarFestival+" Easter Sunday")}e==tY&&t==tM&&(this[tD-1].isToday=!0)}function easter(e){var t=sTerm(e,5),n=new Date(Date.UTC(e,2,t,0,0,0,0)),s=new Lunar(n);if(15>s.day)var a=15-s.day;else var a=(s.isLeap?leapDays(e):monthDays(e,s.month))-s.day+15;var l=new Date(n.getTime()+864e5*a),d=new Date(l.getTime()+864e5*(7-l.getUTCDay()));this.m=d.getUTCMonth(),this.d=d.getUTCDate()}function cDay(e){var t;switch(e){case 10:t="初十";break;case 20:t="二十";break;case 30:t="三十";break;default:t=nStr2[Math.floor(e/10)],t+=nStr1[e%10]}return t}function drawCld(e,t){var n,s,a,l;for(cld=new calendar(e,t),e>1874&&1909>e&&(yDisplay="光绪"+(1==e-1874?"元":e-1874)),e>1908&&1912>e&&(yDisplay="宣统"+(1==e-1908?"元":e-1908)),document.getElementById("GZ").innerHTML='<span class="gznl"> (Year of '+Animals[(e-4)%12]+")</span>",document.getElementById("dtBackground").innerHTML=e+"<br />"+monthName[t],n=0;42>n;n++)sObj=document.getElementById("SD"+n),lObj=document.getElementById("LD"+n),sObj.className="",s=n-cld.firstWeek,s>-1&&cld.length>s?(sObj.innerHTML=s+1,cld[s].isToday&&(sObj.className="todayColor",tdv=sObj.id.split("SD")[1]),sObj.style.color=cld[s].color,1==cld[s].lDay?(lObj.innerHTML="<b>"+(cld[s].isLeap?"闰":"")+cld[s].lMonth+"月"+(29==monthDays(cld[s].lYear,cld[s].lMonth)?"小":"大")+"</b>",lObj.innerHTML=""):(lObj.innerHTML=cDay(cld[s].lDay),lObj.innerHTML=""),a="",a.length>0?a.length>6&&(a=a.substr(0,4)+"..."):(a=cld[s].solarFestival,a.length>0&&(l=a.charCodeAt(0)>0&&128>a.charCodeAt(0)?8:4,a.length>l+2&&(a=a.substr(0,l)+"..."))),a.length>0&&(lObj.innerHTML=a)):(sObj.innerHTML="",lObj.innerHTML="")}function update(){var e,t;e=document.getElementById("CLD").SY.selectedIndex+1900,t=document.getElementById("CLD").SM.selectedIndex,drawCld(e,t)}function navDate(e){switch(e){case"YU":document.getElementById("CLD").SY.selectedIndex>0&&document.getElementById("CLD").SY.selectedIndex--;break;case"YD":150>document.getElementById("CLD").SY.selectedIndex&&document.getElementById("CLD").SY.selectedIndex++;break;case"MU":document.getElementById("CLD").SM.selectedIndex>0?document.getElementById("CLD").SM.selectedIndex--:(document.getElementById("CLD").SM.selectedIndex=11,document.getElementById("CLD").SY.selectedIndex>0&&document.getElementById("CLD").SY.selectedIndex--);break;case"MD":11>document.getElementById("CLD").SM.selectedIndex?document.getElementById("CLD").SM.selectedIndex++:(document.getElementById("CLD").SM.selectedIndex=0,150>document.getElementById("CLD").SY.selectedIndex&&document.getElementById("CLD").SY.selectedIndex++);break;default:document.getElementById("CLD").SY.selectedIndex=tY-1900,document.getElementById("CLD").SM.selectedIndex=tM}update()}function showD(v){var s,festival,sObj=document.getElementById("SD"+v),d=sObj.innerHTML-1;if(""!=sObj.innerHTML){sObj.style.cursor="s-resize",festival=""==cld[d].solarTerms&&""==cld[d].solarFestival&&""==cld[d].lunarFestival?"":'<div class="festival">'+cld[d].solarFestival+" "+cld[d].lunarFestival+"</div>";var hltxt="";if(2008==cld[d].sYear){var hl=eval("HuangLi.d"+(10>cld[d].sMonth?"0"+cld[d].sMonth:cld[d].sMonth)+(10>cld[d].sDay?"0"+cld[d].sDay:cld[d].sDay));hl&&(hltxt='<br /><span class="hlyi">宜：'+hl.y+'</span><br /><span class="hlji">忌：'+hl.j+"</span>")}s='<div class="topic"><div class="disp"><span class="l1">'+cld[d].sMonth+"/"+cld[d].sDay+"/"+cld[d].sYear+"<br />"+cld[d].week+'</span><span class="l2">'+ +cld[d].sDay+"</span>"+"</div>"+festival+"</div>",document.getElementById("theDay").innerHTML=s,0==snow&&(dStyle.left=x+offsetx-width/2+"px",dStyle.top=y+offsety+"px",dStyle.display="block",snow=1)}}function mOut(){cnt>=1&&(sw=0),0==sw?(snow=0,dStyle.display="none"):cnt++}function mEvn(e){null==e&&(e=window.event),x=e.x?e.x:e.pageX,y=e.y?e.y:e.pageY,document.body.scrollLeft?(x=e.x+document.body.scrollLeft,y=e.y+document.body.scrollTop):snow&&(dStyle.left=x+offsetx-width/2+"px",dStyle.top=y+offsety+"px")}function setCookie(e,t){var n=new Date,s=new Date;s.setTime(n.getTime()+31536e6),document.cookie=e+"="+escape(t)+"; expires="+s.toGMTString()}function getCookie(e){var t=e+"=";return document.cookie.length>0?(offset=document.cookie.indexOf(t),-1!=offset?(offset+=t.length,end=document.cookie.indexOf(";",offset),-1==end&&(end=document.cookie.length),unescape(document.cookie.substring(offset,end))):""):void 0}function init(){dStyle=document.getElementById("theDay").style,document.getElementById("CLD").SY.selectedIndex=tY-1900,document.getElementById("CLD").SM.selectedIndex=tM,drawCld(tY,tM),showD(tdv)}function getWeekNumber(e){e=new Date(+e),e.setHours(0,0,0),e.setDate(e.getDate()+4-(e.getDay()||7));var t=new Date(e.getFullYear(),0,1),n=Math.ceil(((e-t)/864e5+1)/7);return[e.getFullYear(),n]}var lunarInfo=[19416,19168,42352,21717,53856,55632,91476,22176,39632,21970,19168,42422,42192,53840,119381,46400,54944,44450,38320,84343,18800,42160,46261,27216,27968,109396,11104,38256,21234,18800,25958,54432,59984,28309,23248,11104,100067,37600,116951,51536,54432,120998,46416,22176,107956,9680,37584,53938,43344,46423,27808,46416,86869,19872,42416,83315,21168,43432,59728,27296,44710,43856,19296,43748,42352,21088,62051,55632,23383,22176,38608,19925,19152,42192,54484,53840,54616,46400,46752,103846,38320,18864,43380,42160,45690,27216,27968,44870,43872,38256,19189,18800,25776,29859,59984,27480,21952,43872,38613,37600,51552,55636,54432,55888,30034,22176,43959,9680,37584,51893,43344,46240,47780,44368,21977,19360,42416,86390,21168,43312,31060,27296,44368,23378,19296,42726,42208,53856,60005,54576,23200,30371,38608,19415,19152,42192,118966,53840,54560,56645,46496,22224,21938,18864,42359,42160,43600,111189,27936,44448,84835],solarMonth=[31,28,31,30,31,30,31,31,30,31,30,31],Gan=["甲","乙","丙","丁","戊","己","庚","辛","壬","癸"],Zhi=["子","丑","寅","卯","辰","巳","午","未","申","酉","戌","亥"],Animals=["Rat","Ox","Tiger","Rabbit","Dragon","Snake","Horse","Goat","Monkey","Rooster","Dog","Pig"],solarTerm=["小寒","大寒","立春","雨水","惊蛰","春分","清明","谷雨","立夏","小满","芒种","夏至","小暑","大暑","立秋","处暑","白露","秋分","寒露","霜降","立冬","小雪","大雪","冬至"],sTermInfo=[0,21208,42467,63836,85337,107014,128867,150921,173149,195551,218072,240693,263343,285989,308563,331033,353350,375494,397447,419210,440795,462224,483532,504758],nStr1=["日","一","二","三","四","五","六","七","八","九","十"],eStr1=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],nStr2=["初","十","廿","卅","□"],monthName=["JAN","FEB","MAR","APR","MAY","JUN","JUL","AUG","SEP","OCT","NOV","DEC"],sFtv=["0101 New Year's Day","0704 Independence Day","1031 Halloween","1111 Veterans Day","1225 Christmas Day"],lFtv=Array("0101 Chinese New Year"),wFtv=["0131 Martin Luthur King Day","0231 President's Day","0520 Mother's Day","0551 Memorial Day","0630 Father's Day","0911 Labor Day","1021 Columbus Day","1144 Thanksgiveing Day"],cld,Today=new Date,tY=Today.getFullYear(),tM=Today.getMonth(),tD=Today.getDate(),width="200",offsetx=2,offsety=8,x=0,y=0,snow=0,sw=0,cnt=0,dStyle;document.onmousemove=mEvn;var tdv;window.onload=init;